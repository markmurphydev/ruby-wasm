<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ruby-Wasm</title>
</head>
<body>
  <button onclick="compile_run_wasm()">Compile and run Wasm</button>
</body>
<script>
    let compile_run_wasm = () => {
        const imports = {
            i64: { toRef: (n) => n },
            arr: {
                new: () => [],
                push: (arr, x) => arr.push(x)
            },
        }
        WebAssembly.instantiateStreaming(fetch("ruby.wasm"), imports).then(
            (obj) => {
                obj.instance.exports.__ruby_top_level_function();
                obj.instance.exports.toggle_cell(4, 5)
                obj.instance.exports.toggle_cell(5, 6)
                obj.instance.exports.toggle_cell(6, 4)
                obj.instance.exports.toggle_cell(6, 5)
                obj.instance.exports.toggle_cell(6, 6)
                console.log(obj.instance.exports.get_cells());
                obj.instance.exports.step();
                console.log(obj.instance.exports.get_cells());
                // const a = obj.instance.exports.fn(22n)
                // console.log(a);
            }
        );
    }
</script>
</html>